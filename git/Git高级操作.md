## Git高级操作

git工作区域图示

![](http://img.fosuchao.com/20200505234355.png)

### 查看所有提交

```git
git log
```

可以看到下图所示的提交信息，包括提交的版本号，作者，日期，分支等。

![](http://img.fosuchao.com/20200505225213.png)

### 回滚版本

```
git reset --mixed 版本号   # 默认, 将缓冲区和归档区进行回滚。
git reset --soft 版本号	# 将归档去进行回滚。
git reset --hard 版本号	# 将工作区，缓冲区和归档区进行回滚。
```

比如上面的版本信息中，我们需要回滚到`a23a8b`开头的版本，直接输入

`git reset --mixed a23a8b`

再次查看提交记录，会发现`a23a8b`后面的提交信息都不见了。

### 查看操作记录

可以查看所有操作，包括回滚操作，可以找到直接回滚的版本号在进行还原回去

```
git reflog
```

### 删除某次提交

`reset`命令是直接回滚到某个版本下，该版本之后的版本会被全部删除。如果我们只需要删除之前的某次提交，这就可以使用到`revert`命令。

```
git revert 版本号
```

回车后，直接输入`:wq`进行保存回车即可。

### 多分支

​		以上操作都是在一个分支下的操作，一般来说我们团队进行开发项目的时候，都是有多个分支进行开发的，然后再将相应的分支合并到主分支上。这样就能防止push的时候产生大量的冲突。

#### 查看分支

```
git branch -v
```

可以看到目前只有一个`master`分支，并且位于`master`分支

![](http://img.fosuchao.com/20200505230910.png)

#### 创建分支

```
git checkout -b b1  # 创建并切换到b1分支
```

可以看到现在有两个分支，分别是b1和master，目前位于b1分支上。

![](http://img.fosuchao.com/20200505231113.png)

#### 合并分支

我们对b1分支上添加了一个`4.txt`文件。

首先切换到`master`分支

```git
git checkout master
```

在某个分支上进行的操作不会影响到其它的分支，现在我们进行对b1进行合并

```
git merge b1
```

这样就把b1分支上的添加或者修改等操作也合并过来了。

#### 合并冲突

比如我们有两个分支b1，b2，分别由两个程序员进行开发。

b1，b2分别都在4.txt的第二行进行了修改。然后b1先进行了合并操作，此时合并是成功的。

后来b2开发完成后想进行合并的时候发现，产生了冲突。

![](http://img.fosuchao.com/20200505232133.png)

为了解决冲突，最后肯定是只能保存b1或者b2分支的其中一个，但是b2总要将修改的东西合并到主分支吧。那就跟b1程序员沟通一下，将他之前修改的那行有冲突的代码覆盖掉好啦。

此时将master回滚到b1合并时的版本，并且切换回b2分支，进行add操作，并且进行提交commit。

![](http://img.fosuchao.com/20200505232551.png)

这时会发现解决了b1和b2的冲突

![](http://img.fosuchao.com/20200505232653.png)

之后我们就可以按照合并主干的操作继续进行了。

### fetch

有时候当远程仓库进行了修改等操作时，我们本地时无法察觉远程仓库的变化的。

此时我们可以使用`git fetch`来查看远程仓库的改变。如果发现远程仓库改变了，我们需要让自己的本地仓库与远程仓库保持一致。这个时候就要使用`git pull`命令，用于将远程最新的分支拉取下来。

### pull request

有时候一个项目拥有很多的开发者，而有些开发者并不具有修改合并master的权限。那我们修改了一些demo，应该怎么合并到master分支上呢？

答案就是使用pull request。请求合并。我们可以在github上看见项目中都有一个fork按钮。当我们点击了fork之后，会发现自己的仓库中多了这个项目，并且可以对它进行修改。如果我们发现某个开源项目有bug的话。就可以先fork下来，修好bug之后，点击`pull request`，这时项目的管理者就会收到这个合并请求，他在看了你的修改后，如果觉得ok就会将你的修改进行合并到`master`上。